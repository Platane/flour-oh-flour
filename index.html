<!doctype html><html><title>ðŸŒ¾ Flour Oh! Flour</title><meta charset="utf-8"><meta property="og:image" content="https://platane.github.io/flour-oh-flour/images/1200x750.jpg"><meta name="description" content="Reap wheat, Gather flour, Enjoy the farm life in this game made for the 2020 js13kGames.com competition."><meta name="viewport" content="width=device-width,initial-scale=1"><body><canvas style="position:fixed;top:0;left:0;width:100%;height:100%;touch-action:none;background-image:radial-gradient(rgb(251 251 251),#fffdeb 60%)"></canvas><div id="splash" style="position:fixed;top:0;left:0;width:100%;height:100%;backdrop-filter:blur(5px);transition:opacity .2s ease;font-family:Helvetica,Arial,sans-serif;padding:40px;color:#333;background-color:#fffef333"><h1>Flour<br>Oh!<br>Flour</h1><span>ðŸŒ¾ðŸŒ¾ðŸŒ¾</span><h4>Reap wheat<br>Gather flour<br>Enjoy the farm life</h4></div></body><script>let t=document.querySelector("canvas");t.width=window.innerWidth*window.devicePixelRatio,t.height=window.innerHeight*window.devicePixelRatio;let a={t:1,o:1},e=t.getContext("webgl2",a)||t.getContext("webgl",a);var r="undefined"!=typeof Float32Array?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,a=arguments.length;a--;)t+=arguments[a]*arguments[a];return Math.sqrt(t)});var o,n=()=>{var t=new r(16);return r!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},l=(t,a,e)=>{var r=a[0],o=a[1],n=a[2],l=a[3],h=a[4],M=a[5],i=a[6],f=a[7],c=a[8],s=a[9],u=a[10],v=a[11],w=a[12],g=a[13],d=a[14];a=a[15];var p=e[0],A=e[1],y=e[2],m=e[3];return t[0]=p*r+A*h+y*c+m*w,t[1]=p*o+A*M+y*s+m*g,t[2]=p*n+A*i+y*u+m*d,t[3]=p*l+A*f+y*v+m*a,t[4]=(p=e[4])*r+(A=e[5])*h+(y=e[6])*c+(m=e[7])*w,t[5]=p*o+A*M+y*s+m*g,t[6]=p*n+A*i+y*u+m*d,t[7]=p*l+A*f+y*v+m*a,t[8]=(p=e[8])*r+(A=e[9])*h+(y=e[10])*c+(m=e[11])*w,t[9]=p*o+A*M+y*s+m*g,t[10]=p*n+A*i+y*u+m*d,t[11]=p*l+A*f+y*v+m*a,t[12]=(p=e[12])*r+(A=e[13])*h+(y=e[14])*c+(m=e[15])*w,t[13]=p*o+A*M+y*s+m*g,t[14]=p*n+A*i+y*u+m*d,t[15]=p*l+A*f+y*v+m*a,t},h=(t,a)=>(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t),M=(t,a)=>(t[0]=a[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=a[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t),i=(t,a)=>(t[0]=a[0],t[1]=a[1],t[2]=a[2],t),f=(t,a,e)=>(t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t),c=(t,a,e)=>(t[0]=a[0]-e[0],t[1]=a[1]-e[1],t[2]=a[2]-e[2],t),s=(t,a,e)=>(t[0]=a[0]*e,t[1]=a[1]*e,t[2]=a[2]*e,t),u=(t,a,e,r)=>(t[0]=a[0]+e[0]*r,t[1]=a[1]+e[1]*r,t[2]=a[2]+e[2]*r,t),v=(t,a)=>Math.hypot(a[0]-t[0],a[1]-t[1],a[2]-t[2]),w=(t,a)=>{var e=a[0]-t[0],r=a[1]-t[1];return e*e+r*r+(t=a[2]-t[2])*t},g=(t,a)=>{var e=a[0],r=a[1],o=a[2];return 0<(e=e*e+r*r+o*o)&&(e=1/Math.sqrt(e)),t[0]=a[0]*e,t[1]=a[1]*e,t[2]=a[2]*e,t},d=(t,a)=>t[0]*a[0]+t[1]*a[1]+t[2]*a[2],p=(t,a,e)=>{var r=a[0],o=a[1],n=e[0],l=e[1];return t[0]=o*(e=e[2])-(a=a[2])*l,t[1]=a*n-r*e,t[2]=r*l-o*n,t},A=(t,a,e,r)=>{var o=a[0],n=a[1];return a=a[2],t[0]=o+r*(e[0]-o),t[1]=n+r*(e[1]-n),t[2]=a+r*(e[2]-a),t},y=(t,a,e)=>{var r=a[0],o=a[1],n=e[3]*r+e[7]*o+e[11]*(a=a[2])+e[15];return t[0]=(e[0]*r+e[4]*o+e[8]*a+e[12])/(n=n||1),t[1]=(e[1]*r+e[5]*o+e[9]*a+e[13])/n,t[2]=(e[2]*r+e[6]*o+e[10]*a+e[14])/n,t},m=(t,a,e)=>{var r=a[0],o=a[1];return t[0]=r*e[0]+o*e[3]+(a=a[2])*e[6],t[1]=r*e[1]+o*e[4]+a*e[7],t[2]=r*e[2]+o*e[5]+a*e[8],t},F=(t,a,e,r)=>{var o=[],n=[];return o[0]=a[0]-e[0],o[1]=a[1]-e[1],o[2]=a[2]-e[2],n[0]=o[0]*Math.cos(r)-o[1]*Math.sin(r),n[1]=o[0]*Math.sin(r)+o[1]*Math.cos(r),n[2]=o[2],t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t};o=new r(3),r!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0);var b=(t,a)=>Math.hypot(a[0]-t[0],a[1]-t[1]),B=(t,a)=>{var e=a[0]-t[0];return e*e+(t=a[1]-t[1])*t};(()=>{var t=new r(2);r!=Float32Array&&(t[0]=0,t[1]=0)})();let D=(t,a,e)=>(1-t)*a+t*e,x=[0,0,0],k=[0,1,0],z=[0,-1,0],X=[0,0,1],Y=[1,0,0],C=[],q=[],I=[],_=[],P=[],S=new Float32Array(16);var E=1/Math.tan(.5236);S[0]=E/(window.innerWidth/window.innerHeight),S[1]=0,S[2]=0,S[3]=0,S[4]=0,S[5]=E,S[6]=0,S[7]=0,S[8]=0,S[9]=0,S[11]=-1,S[12]=0,S[13]=0,S[15]=0,S[10]=1/-19.995*20.005,S[14]=-.010002500625156289;let G=1.2,T=1,U=5,j=[0,0,0],H=[0,0,1],J=new Float32Array(16),K=new Float32Array(16),L=new Float32Array(9),N=()=>{var t=.8+.09*U,a=Math.sin(G)*t;H[0]=a*Math.sin(T),H[1]=Math.cos(G)*t,H[2]=a*Math.cos(T),t=H[0],a=H[1];var e=H[2],r=k[0],o=k[1],n=k[2],h=j[0],M=j[1],i=j[2];if(1e-6>Math.abs(t-h)&&1e-6>Math.abs(a-M)&&1e-6>Math.abs(e-i))J[0]=1,J[1]=0,J[2]=0,J[3]=0,J[4]=0,J[5]=1,J[6]=0,J[7]=0,J[8]=0,J[9]=0,J[10]=1,J[11]=0,J[12]=0,J[13]=0,J[14]=0;else{h=t-h,M=a-M;var f=e-i,c=1/Math.hypot(h,M,f);i=o*(f*=c)-n*(M*=c),n=n*(h*=c)-r*f,r=r*M-o*h,(c=Math.hypot(i,n,r))?(i*=c=1/c,n*=c,r*=c):r=n=i=0,o=M*r-f*n;var s=f*i-h*r,u=h*n-M*i;(c=Math.hypot(o,s,u))?(o*=c=1/c,s*=c,u*=c):u=s=o=0,J[0]=i,J[1]=o,J[2]=h,J[3]=0,J[4]=n,J[5]=s,J[6]=M,J[7]=0,J[8]=r,J[9]=u,J[10]=f,J[11]=0,J[12]=-(i*t+n*a+r*e),J[13]=-(o*t+s*a+u*e),J[14]=-(h*t+M*a+f*e)}J[15]=1,l(K,S,J),L[0]=J[0],L[1]=J[1],L[2]=J[2],L[3]=J[4],L[4]=J[5],L[5]=J[6],L[6]=J[8],L[7]=J[9],L[8]=J[10],(u=(t=L[0])*(r=(n=L[8])*(M=L[4])-(i=L[5])*(c=L[7]))+(a=L[1])*(o=-n*(h=L[3])+i*(f=L[6]))+(e=L[2])*(s=c*h-M*f))&&(L[0]=r*(u=1/u),L[1]=(-n*a+e*c)*u,L[2]=(i*a-e*M)*u,L[3]=o*u,L[4]=(n*t-e*f)*u,L[5]=(-i*t+e*h)*u,L[6]=s*u,L[7]=(-c*t+a*f)*u,L[8]=(M*t-a*h)*u)};N();let O=0,Q=null,R=null,V=null,W=([{pageX:t,pageY:a}])=>{null!==R&&(T-=(t-R)/window.innerHeight*3,G-=(a-V)/window.innerHeight*3,G=Math.min(Math.max(G,.62832),1.382304),R=t,V=a,N())},Z=t=>{if(null!==Q){const[{pageX:a,pageY:e},{pageX:r,pageY:o}]=t;U=Math.min(Math.max(O/Math.sqrt((a-r)**2+(e-o)**2)*Q,0),10),N()}},$=t=>{1===t.length?(Q=null,(([{pageX:t,pageY:a}])=>{R=t,V=a})(t)):1<t.length&&(R=null,(([{pageX:t,pageY:a},{pageX:e,pageY:r}])=>{O=U,Q=Math.sqrt((t-e)**2+(a-r)**2)})(t))};t.addEventListener("wheel",t=>{U=Math.min(Math.max(U+(0>t.deltaY?-1:1),0),10),N()},{passive:1});let tt=t=>6*t*t*t*t*t-15*t*t*t*t+10*t*t*t,at=(t,a,e)=>{const r=Math.ceil(a/e)+1,o=Array.from({length:(Math.ceil(t/e)+1)*r}).map(()=>{const t=6.2832*Math.random();return{x:Math.cos(t),y:Math.sin(t)}});return(t,a)=>{const n=t/e,l=a/e,h=Math.floor(n),M=Math.floor(l);t=n-h,a=l-M;const i=[{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1}].map(t=>{const a=o[(h+t.x)*r+(M+t.y)];return a.x*(h+t.x-n)+a.y*(M+t.y-l)});return D(tt(a),D(tt(t),i[0],i[1]),D(tt(t),i[2],i[3]))}},et=(t,a,e)=>{{var r=(t[0]+a[0])/2;const o=(t[1]+a[1])/2,n=-(t[1]-a[1]);a=t[0]-a[0];const l=(t[0]+e[0])/2,h=(t[1]+e[1])/2,M=-(t[1]-e[1]);e=t[0]-e[0],r=1e-6>Math.abs(n*e-a*M)?null:[r+n*(e=1e-6>Math.abs(M)?(l-r)/n:1e-6>Math.abs(e)?(h-o)/a:((r-l)/M-(o-h)/e)/(a/e-n/M)),o+a*e]}return r?{l:r,h:B(r,t)}:null},rt=t=>{const a=t.length;var e=(t=>{const a=Math.max(0,...t.map(t=>t[0]))+1,e=Math.max(0,...t.map(t=>t[1]))+1,r=Math.min(0,...t.map(t=>t[0]))-1;return[[r,t=Math.min(0,...t.map(t=>t[1]))-1],[r,e+(e-t)],[a+(a-r),t]]})(t);t.push(...e);const r=[{M:[a+2,a+1,a+0],i:et(e[0],e[1],e[2])}];for(let o=a;o--;){const a=[];for(e=r.length;e--;){const{i:{l:n,h:l},M:[h,M,i]}=r[e];B(n,t[o])<l&&(r.splice(e,1),a.push([h,M],[h,i],[M,i]))}a.forEach(([e,n])=>{1===a.filter(([t,a])=>e===t&&n===a).length&&r.push({M:[e,n,o],i:et(t[e],t[n],t[o])})})}return t.splice(a,3),r.filter(({M:t})=>!t.some(t=>t>=a))},ot=0,nt=[],lt=[],ht=[],Mt=[],it=[240/255,120/255,0],ft=[.12,.72,.18],ct=[130/255,134/255,38/255],st=[.98,.98,.3],ut=[212/255,198/255,181/255],vt=[157/255,116/255,.2],wt=[132/255,82/255,25/255],gt=(t,a,e,r,o)=>{const n=e[0]-a[0],l=e[1]-a[1];a=e[2]-a[2],e=o[0]-r[0];const h=o[1]-r[1];return t[0]=l*(r=o[2]-r[2])-a*h,t[1]=a*e-n*r,t[2]=n*h-l*e,t},dt=(t,a,e)=>{let r=0;for(let h=0;h<t.length;h++){var o=t[h],n=t[(h+1)%t.length],l=n[0]-o[0];const M=n[1]-o[1];n=n[2]-o[2];const i=e[0]-o[0],f=e[1]-o[1];if(l=a[0]*(M*(o=e[2]-o[2])-n*f)+a[1]*(n*i-l*o)+a[2]*(l*f-M*i),1e-6<Math.abs(l)){if(0>r*l)return 0;r=0<l?1:-1}}return 1},pt=t=>{var a=0;for(let l=0;l<t.length-1;l++){{var e=t[0],r=t[l],o=t[l+1],n=r[0]-e[0];const a=r[1]-e[1];r=r[2]-e[2];const h=o[0]-e[0],M=o[1]-e[1];e=o[2]-e[2],n=Math.hypot(a*e-r*M,r*h-n*e,n*M-a*h)/2}a+=n}return a},At=(t,a)=>{t[0]=0,t[1]=0,t[2]=0;for(let e=a.length;e--;)u(t,t,a[e],1/a.length);return t},yt=t=>{const a=At([],t);let e=0;for(let r=t.length;r--;)e=Math.max(e,w(t[r],a));return Math.sqrt(e)},mt=new Float32Array(252e3),Ft=new Float32Array(252e3),bt=new Float32Array(252e3),Bt=0,Dt=(t,a,e)=>{for(let r=1;r<t.length-1;r++){mt[9*Bt]=t[0][0],mt[9*Bt+1]=t[0][1],mt[9*Bt+2]=t[0][2],mt[9*Bt+3]=t[r+0][0],mt[9*Bt+4]=t[r+0][1],mt[9*Bt+5]=t[r+0][2],mt[9*Bt+6]=t[r+1][0],mt[9*Bt+7]=t[r+1][1],mt[9*Bt+8]=t[r+1][2];for(let t=9;t--;)Ft[9*Bt+t]=e[t%3],bt[9*Bt+t]=a[t%3];Bt++}},xt=[],kt=(t,a)=>{gt(xt,t[0],t[1],t[0],t[2]),g(xt,xt),Dt(t,a,xt)},zt=[[.3,1.1],[.2,.05],[1.12,.6],[1.3,1.25]],Xt=(t,a,e)=>{p(C,a,X),g(C,C);var r=e/100,o=(1-2*Math.abs(Math.max(0,(r-(1-.07))/.07)-.5))**2;e=A(q,ct,st,r);const n=.009*1.5*r,l=9e-4*r,h=.009*.3*r+.00198*o;r=[s([],C,-l),s([],C,l)].map(a=>(m(a,a,L),f(a,a,t),a[1]-=.04*n,a)),s(o=[],a,n+6*h/2),f(o,o,t),r.push(o),Dt(r,e,X);for(let o=6;o--;){const l=o>>1,M=o%2?1:-1;r=zt.map(([e,r])=>(m(e=[(r+.05*(1.1-o/6))*M*h,(e-.5)*h,0],e,L),f(e,e,t),u(e,e,a,n+(l+.1*M)*h),e)),1===M&&r.reverse(),Dt(r,e,X)}},Yt=new Float32Array(252e3),Ct=new Float32Array(252e3),qt=new Float32Array(252e3),It=0,_t=(t,a,e)=>{for(let r=1;r<t.length-1;r++){Yt[9*It]=t[0][0],Yt[9*It+1]=t[0][1],Yt[9*It+2]=t[0][2],Yt[9*It+3]=t[r+0][0],Yt[9*It+4]=t[r+0][1],Yt[9*It+5]=t[r+0][2],Yt[9*It+6]=t[r+1][0],Yt[9*It+7]=t[r+1][1],Yt[9*It+8]=t[r+1][2];for(let t=9;t--;)Ct[9*It+t]=e[t%3],qt[9*It+t]=a[t%3];It++}},Pt=[],St=(t,a)=>{gt(Pt,t[0],t[1],t[0],t[2]),g(Pt,Pt),_t(t,a,Pt)},Et=[],Gt=[],Tt=[],Ut=[],jt=[],Ht=[],Jt=[],Kt=[],Lt=[],Nt=(t,a,e,r)=>{var o=K[0],n=K[1],l=K[2],h=K[3],M=K[4],i=K[5],f=K[6],s=K[7],u=K[8],v=K[9],w=K[10],d=K[11],p=K[12],A=K[13],m=K[14],F=K[15],b=o*i-n*M,B=o*f-l*M,D=o*s-h*M,x=n*f-l*i,k=n*s-h*i,z=l*s-h*f,X=u*A-v*p,Y=u*m-w*p,C=u*F-d*p,q=v*m-w*A,I=v*F-d*A,_=w*F-d*m,P=b*_-B*I+D*q+x*C-k*Y+z*X;return P&&(Et[0]=(i*_-f*I+s*q)*(P=1/P),Et[1]=(l*I-n*_-h*q)*P,Et[2]=(A*z-m*k+F*x)*P,Et[3]=(w*k-v*z-d*x)*P,Et[4]=(f*C-M*_-s*Y)*P,Et[5]=(o*_-l*C+h*Y)*P,Et[6]=(m*D-p*z-F*B)*P,Et[7]=(u*z-w*D+d*B)*P,Et[8]=(M*I-i*C+s*X)*P,Et[9]=(n*C-o*I-h*X)*P,Et[10]=(p*k-A*D+F*b)*P,Et[11]=(v*D-u*k-d*b)*P,Et[12]=(i*Y-M*q-f*X)*P,Et[13]=(o*q-n*Y+l*X)*P,Et[14]=(A*B-p*x-m*b)*P,Et[15]=(u*x-v*B+w*b)*P),y(Lt,[t,a,.5],Et),c(Lt,Lt,H),g(Lt,Lt),Rt(H,Lt,e,r)},Ot=[],Qt=[],Rt=(t,a,e,r)=>{let o=Infinity,n=[0,0,0],l=-1;for(let M=0;M<9*r;M+=9){Gt[0]=e[M+0+0],Gt[1]=e[M+0+1],Gt[2]=e[M+0+2],Tt[0]=e[M+3+0],Tt[1]=e[M+3+1],Tt[2]=e[M+3+2],Ut[0]=e[M+6+0],Ut[1]=e[M+6+1],Ut[2]=e[M+6+2],c(Ht,Tt,Gt),c(Jt,Ut,Tt),c(Kt,Gt,Ut),p(jt,Ht,Jt),g(jt,jt);var h=d(jt,a);if(1e-6<Math.abs(h)&&(c(Ot,Gt,t),(h=d(jt,Ot)/h)<o)){Qt[0]=t[0]+h*a[0],Qt[1]=t[1]+h*a[1],Qt[2]=t[2]+h*a[2];const e=0<d(jt,p(Ot,Ht,c(Ot,Gt,Qt))),r=0<d(jt,p(Ot,Jt,c(Ot,Tt,Qt))),i=0<d(jt,p(Ot,Kt,c(Ot,Ut,Qt)));e===r&&e===i&&(o=h,n[0]=Qt[0],n[1]=Qt[1],n[2]=Qt[2],l=M/9)}}if(0<=l)return{s:n,u:o,v:l}},Vt=null,Wt=-9999,Zt=([{pageX:t,pageY:a}])=>{(t=Nt(t/window.innerWidth*2-1,-(a/window.innerHeight*2-1),Yt,Ga))&&(Vt=t.s,Wt=ot)},$t=[],ta=[0,0,0],aa=0,ea=0,ra=0,oa=(t,a)=>{var e=1.3*ot+.18*Math.sin(2.7*ot+a[0]**2)+.3*Math.sin(1.7*ot+2*a[2])+.2*Math.sin(782*a[2]+2132*a[0]);const r=(4+1*Math.sin(2*ot+1*a[0])+2*Math.sin(3.8*ot+2*a[2]))/7;return t[0]=Math.cos(e)*r,t[1]=2,t[2]=Math.sin(e)*r,g(t,t),aa!==ot&&(e=0,ht.length&&.15>ot-ht[ht.length-1].g?(e=3.6,i(ta,ht[ht.length-1].s)):Vt&&.15>ot-Wt&&(e=1,i(ta,Vt)),ea+=(160*(e-ra)-12*ea)*(ot-aa),ra+=ea*(ot-aa),aa=ot),1e-6<Math.abs(ra)&&(c($t,a,ta),e=Math.hypot($t[0],$t[1],$t[2]),u(t,t,$t,ra/(1e-4+e*Math.max(e+.003*Math.sin(783*a[2]+132*a[0]+ot),.001))*.016),g(t,t)),t},na=[],la=[[-.2,.45,0],[-.2,-.45,0],[.4,0,0]],ha=(t,a)=>{const e=At([],t),r=yt(t),o=[],n=[],l=[];c(n,t[1],t[0]),c(o,t[2],t[0]),p(l,n,o),g(l,l),p(o,l,n),g(o,o),p(n,o,l);const h=[],M=1+.026*Math.ceil(r/.026),v=1+.026*Math.ceil(r/.026);for(let a=-M;a<=M;a+=.026)for(let r=-v;r<=v;r+=.026)i(q,e),u(q,q,o,a+.0078*(Math.random()-.5)),u(q,q,n,r+.0078*(Math.random()-.5)),dt(t,l,q)&&h.push(q.slice());const w=Mt[a];return()=>{for(var M of h)Xt(M,oa(I,M),Mt[a].p);if("grown"===w.type)if(0<w.A){M=Math.min(Math.max(w.A/11,0),1),i(C,e),u(C,C,l,5e-4);for(var v=t.length;v--;){var d=t[(v+1)%t.length];i(q,t[v]),i(I,d),u(q,q,l,5e-4),u(I,I,l,5e-4),c(_,C,q),c(P,C,I),s(_,_,M),s(P,P,M),f(_,_,q),f(P,P,I),Dt([q,I,P,_],it,l)}}else if(0==(0|1754*ot+a)%15){for(M=[999999,999999,999999];!dt(t,l,M);)i(M,e),u(M,M,o,2*(Math.random()-.5)*r),u(M,M,n,2*(Math.random()-.5)*r);v=.048*(1+2*Math.random()),d=i([],M),u(d,d,k,v);var p=3*Math.random();na.push({m:M,F:d,B:p,D:p+.2*(Math.random()-.5),k:.0096,X:.0024,Y:ot,duration:15*v,color:it})}if("growing"===w.type)for(M=80*(.27-(ot-w.C)),v=0;v<M;v++){d=[9999,9999,9999];for(var A=p=0;.03>p*p+A*A||!dt(t,l,d);)p=2*(Math.random()-.5),A=2*(Math.random()-.5),i(d,e),u(d,d,o,r*p),u(d,d,n,r*A);c(C,d,e),u(C,C,l,Math.max(.01*r,(r-Math.hypot(C[0],C[1],C[2]))*(.7+Math.random()+.7))),g(C,C),p=.2*.2*(1+5*Math.random()),A=i([],d),u(A,A,C,p);const a=3*Math.random();na.push({m:d,F:A,B:a,D:a+.9*(Math.random()-.5),k:.2*.07,X:.2*.1+.002*(Math.random()+2),Y:ot,duration:.45*p,color:.7<Math.random()?st.map(t=>Math.min(Math.max(t+.37*(Math.random()-.5),0),1)):it})}for(const t of ht)if(t.v===a)for(M=0;M<12*(.12-(ot-t.g));M++)v=i([],t.s),i(C,x),d=6.2832*Math.random(),u(C,C,o,Math.sin(d)),u(C,C,n,Math.cos(d)),u(v,v,C,.072*Math.random()),d=.06*(1+.8*Math.random()),u(C,C,l,Math.random()+.1),g(C,C),p=i([],v),u(p,p,C,d),A=3*Math.random(),na.push({m:v,F:p,B:A,D:A+.9*(Math.random()-.5),k:.0126,X:.018+.0018*(Math.random()+2),Y:ot,duration:2*d,color:.7<Math.random()?st.map(t=>Math.min(Math.max(t+.37*(Math.random()-.5),0),1)):it})}},Ma=t=>{const a=[0,2.16,-1.17];for(let a=0;5>a;a++){var e=6.2832*a/5,r=6.2832*(a+1)/5;const o=Math.sin(e),n=Math.sin(r);e=Math.cos(e),r=Math.cos(r);for(const a of[[[1.25*o,.6,1.25*e],[1.25*n,.6,1.25*r],[1*n,2.4,1*r],[1*o,2.4,1*e]],[[.95*o,0,.95*e],[.95*n,0,.95*r],[.5*n,.66,.5*r],[.5*o,.66,.5*e]],[[.95*n,0,.95*r],[.95*o,0,.95*e],[.95*o,-1.85,.95*e],[.95*n,-1.85,.95*r]],[[1.32*o,2.4,1.32*e],[1.32*n,2.4,1.32*r],[0,3.08,0]],[[0,.24,0],[1.25*n,.6,1.25*r],[1.25*o,.6,1.25*e]],[[0,2.4,0],[1.32*n,2.4,1.32*r],[1.32*o,2.4,1.32*e]]])St(a.map(a=>y([],a,t)),wt);let l=r-e,h=n-o;const M=Math.sqrt(h*h+l*l);l/=M,h/=M;for(const a of[[[1.305*o+.18*h,.6,1.305*e+.18*l],[1.055*o+.18*h,2.4,1.055*e+.18*l],[1.055*o,2.4,1.055*e],[1.305*o,.6,1.305*e]],[[1.055*n-.18*h,2.4,1.055*r-.18*l],[1.305*n-.18*h,.6,1.305*r-.18*l],[1.305*n,.6,1.305*r],[1.055*n,2.4,1.055*r]],[[1.305*n-.18*h,.6,1.305*r-.18*l],[1.055*n-.18*h,2.4,1.055*r-.18*l],[1*n-.18*h,2.4,1*r-.18*l],[1.25*n-.18*h,.6,1.25*r-.18*l]],[[1.055*o+.18*h,2.4,1.055*e+.18*l],[1.305*o+.18*h,.6,1.305*e+.18*l],[1.25*o+.18*h,.6,1.25*e+.18*l],[1*o+.18*h,2.4,1*e+.18*l]],[[1.055*o+.18*h,2.4,1.055*e+.18*l],[1.305*o+.18*h,.6,1.305*e+.18*l],[1.25*o+.18*h,.6,1.25*e+.18*l],[1*o+.18*h,2.4,1*e+.18*l]],[[0,2.455+.68,0],[.396/.68*o,2.455+.68-.3,.396/.68*e],[.396/.68*n,2.455+.68-.3,.396/.68*r]],[[.396/.68*n,3.08-.3+.055,.396/.68*r],[.396/.68*o,3.08-.3+.055,.396/.68*e],[.396/.68*o,3.08-.3,.396/.68*e],[.396/.68*n,3.08-.3,.396/.68*r]]])St(a.map(a=>y([],a,t)),vt)}return()=>{for(let e=4;e--;)for(const r of[[[.04-.1,.1,.035],[.14,.1,.035],[.44,2,.035],[.04-.4,2,.035]],[[.44,2,-.035],[.14,.1,-.035],[.04-.1,.1,-.035],[.04-.4,2,-.035]],[[.44,2,-.035],[.44,2,.035],[.14,.1,.035],[.14,.1,-.035]],[[.04-.4,2,.035],[.04-.4,2,-.035],[.04-.1,.1,-.035],[.04-.1,.1,.035]],[[.04-.4,2,.035],[.44,2,.035],[.44,2,-.035],[.04-.4,2,-.035]],[[.14,.1,-.035],[.14,.1,.035],[.04-.1,.1,.035],[.04-.1,.1,-.035]]])kt(r.map(r=>{const o=[];f(r,r,a);var n=[],l=[];return n[0]=r[0]-a[0],n[1]=r[1]-a[1],n[2]=r[2]-a[2],l[0]=n[2]*Math.sin(-.16)+n[0]*Math.cos(-.16),l[1]=n[1],l[2]=n[2]*Math.cos(-.16)-n[0]*Math.sin(-.16),r[0]=l[0]+a[0],r[1]=l[1]+a[1],r[2]=l[2]+a[2],F(r,r,a,9+3.1416*e/2+1.25664*ot),y(o,r,t),o}),ut)}},ia=[k,Y,X],fa=[{q:[[[0,0,0],[.15,0,0],[.15,1,0],[0,1,0]],[[.85,0,0],[1,0,0],[1,1,0],[.85,1,0]],[[.15,0,0],[.85,0,0],[.85,.15,0],[.15,.15,0]],[[.85,1,0],[.15,1,0],[.15,.85,0],[.85,.85,0]]],color:vt},{q:[[[.04,.04,.04],[.96,.04,.04],[.96,.96,.04],[.04,.96,.04]]],color:wt},{q:[Array.from({length:3}).map((t,a,e)=>[.17*Math.sin(412+-a/e.length*6.2832)+.5,.17*Math.cos(412+-a/e.length*6.2832)+.5,.035])],color:st}],ca=(t,a)=>{for(let e=6;e--;){const r=ia[(e+0)%3],o=ia[(e+1)%3],n=ia[(e+2)%3],l=3<=e?1:-1;for(const{q:e,color:h}of fa)for(const M of e){const e=M.map(([a,e,h])=>{const M=[0,0,0];return u(M,M,n,.016*(a-.5)),u(M,M,r,.016*(e-.5)),u(M,M,o,.016*(h-.5)*l),y(M,M,t),M});-1===l&&e.reverse(),a(e,h)}}},sa=at(1,1,.35),ua=Array.from({length:6},()=>[.46*Math.random()+.27,.46*Math.random()+.27,.1*(1+Math.random())]),va=(t,a)=>.5<ua.reduce((e,[r,o,n])=>(r-=t,o-=a,e+Math.exp((r*r+o*o)/(n*n)*-.5)),0)+1.7*sa(t,a)*(.4+.6*(.5-Math.sqrt((t-.5)**2+(a-.5)**2))),wa=[];for(;60>wa.length;){let t=Math.random(),a=Math.random(),e=[t,a];va(t,a)&&wa.every(t=>5e-4<B(e,t))&&wa.push(e)}let ga=At([],wa),da=(t,a)=>{var e=[];e[0]=t,e[1]=a,e[0]-=ga[0],e[1]-=ga[1];var r=e[0],o=e[1];for(0<(r=r*r+o*o)&&(r=1/Math.sqrt(r)),e[0]*=r,e[1]*=r,r=Infinity,o=26;o--;){var n=1e-6+.15*Math.random();const o=n*(Math.random()-.5)*.7,l=t+n*e[0]+o*e[1],h=a+n*e[1]-o*e[0];(n=n*n+o*o)<r&&!(0<=l&&1>l&&0<=h&&1>h&&va(l,h))&&(r=n)}return Math.min(1,Math.sqrt(r)/.15)},pa=at(3,3,.14),Aa=at(3,3,.32),ya=at(3,3,.73),ma=(t,a)=>{let e;return e=.5*pa(t+1.2,a+1.16)-.3,e+=.6*Aa(t+1.7,a+1.6),e+=.8*ya(t+1.57,a+1.2),.3*(.7*(t=da(t,a))+e*t)},Fa=(t=>{const a=rt(t),e=[];for(t=t.length;t--;){const n=[];for(var r=a.length;r--;r)a[r].M.includes(t)&&n.push(r);if(0===n.length)break;var o=n.shift();let l,h;r=[o];for(let e=3;e--;)a[o].M[e]===t&&(l=a[o].M[(e+1)%3],h=a[o].M[(e+2)%3]);for(;-1!==(o=n.findIndex(t=>a[t].M.includes(l)));){o=n.splice(o,1)[0],r.push(o);for(const e of a[o].M)if(e!==l&&e!==t){l=e;break}if(h===l){e.push(r);break}}}return{q:e,I:a.map(({i:t})=>t.l)}})(wa),ba=Fa.I.map(([t,a])=>[t,a,0<=t&&1>t&&0<=a&&1>a?ma(t,a):0]),Ba=[],Da=[];for(;Fa.q.length&&8>Da.length;){let[t]=Fa.q.splice(Math.floor(Math.random()*Fa.q.length),1),a=t.map(t=>ba[t]);if(a.some(t=>{var a=t[0],e=t[1];return!(0<=a&&1>a&&0<=e&&1>e)||.14>da(t[0],t[1])}))continue;if(a.some((t,a,e)=>.005>b(e[a],e[(a+1)%e.length])))continue;let e=3.1416*yt(a)**2,r=pt(a),o=r/e;if(.006>r||.3>o)continue;let n=t.filter(t=>Ba[t]);if(2<n.length)continue;for(;3>n.length;){let a=0,e=0;for(let r of t)if(!n.includes(r)){let t=n.reduce((t,a)=>t+v(ba[r],ba[a]),0);t>a&&(e=r,a=t)}n.push(e)}let l=p([],c(q,ba[n[1]],ba[n[0]]),c(I,ba[n[1]],ba[n[2]]));g(l,l);let h=[];for(let a=0;a<t.length;a++){let e=d(l,c(q,ba[t[a]],ba[n[0]]))/d(l,X);h[a]=e}if(!h.some(t=>.05<Math.abs(t))){for(let a=0;a<t.length;a++)u(ba[t[a]],ba[t[a]],X,-h[a]),Ba[t[a]]=1;Da.push(a)}}let xa=Da.flat(1).filter((t,a,e)=>a===e.indexOf(t));xa.push(...Da.map(t=>At([],t)));let ka=Da.map(t=>((t,a)=>{const e=At([],t);return t.map(t=>{t=c([],t,e);const a=Math.hypot(t[0],t[1],t[2]);return s(t,t,(a+.04)/a),f(t,t,e)})})(t).map(t=>[t[0],t[1],0])),za=0;for(;100>za&&800>xa.length;){let t=Math.random(),a=Math.random(),e=[t,a];va(t,a)&&!ka.some(e=>dt(e,X,[t,a,0]))&&xa.every(t=>5e-5<B(e,t))?(za=0,e.push(ma(t,a)),xa.push(e)):za++}xa.slice();let Xa=rt(xa).map(({M:t})=>t),Ya=[];for(let t of Da)for(let a=t.length;a--;){let e=t[a],r=t[(a+1)%t.length];Ya.some(([t,a])=>t===e&&a===r||a===e&&t===r)||Ya.push([e,r])}for(let t=3;t--;)t:for(let t=Xa.length;t--;)for(let a=3;a--;){let e=Xa[t][a],r=Xa[t][(a+1)%3],o=xa[e],n=xa[r];for(let[a,l]of Ya){var Ca;a:{let t=void 0,e=void 0;const r=a[0],h=a[1],M=o[0],i=o[1],f=l[0]-a[0],c=l[1]-a[1],s=n[0]-o[0],u=n[1]-o[1];if(1e-6>Math.abs(f*u-c*s)){Ca=null;break a}if(e=1e-6>Math.abs(s)?(M-r)/f:1e-6>Math.abs(u)?(i-h)/c:((r-M)/s-(h-i)/u)/(c/u-f/s),0>e||1<e){Ca=null;break a}const v=r+e*f,w=h+e*c;t=1e-6<Math.abs(s)?(v-M)/s:(w-i)/u,Ca=0>t||1<t?null:[v,w,e,t]}let h=Ca;if(h&&1e-6<h[2]&&1e-6<1-h[2]&&1e-6<h[3]&&1e-6<1-h[3]){let o=A([],a,l,h[2]),n=xa.length;xa.push(o);for(let a=Xa.length;a--;)if(Xa[a].includes(e)&&Xa[a].includes(r)){let[o]=Xa.splice(a,1);a!==t&&(t=Math.max(0,t-1));let l=0;for(let t of o)t!==e&&t!==r&&(l=t);Xa.push([e,l,n],[r,l,n])}continue t}}}for(let t=Xa.length;t--;){let a=At([],Xa[t].map(t=>xa[t]));Da.some(t=>dt(t,X,[a[0],a[1],0]))&&Xa.splice(t,1)}for(let t=Xa.length;t--;){let a=At(q,Xa[t].map(t=>xa[t]));va(a[0],a[1])||Xa.splice(t,1)}for(let t=Xa.length;t--;)for(let a=3;a--;){let e=Xa[t][a],r=Xa[t][(a+1)%3],o=0;for(let t=Xa.length;t--;)for(let a=3;a--;){let n=Xa[t][a],l=Xa[t][(a+1)%3];(e===n&&r===l||e===l&&r===n)&&o++}if(1===o){let t=xa.length;xa.push(...[xa[e],xa[r]].map(t=>{let a=[t[0]-ga[0],t[1]-ga[1],0];return g(a,a),a[2]=-5,g(a,a),s(a,a,.1),f(a,a,t),a}).reverse()),Xa.push([e,r,t],[e,t+1,t])}}let qa=[],Ia=[],_a=n();l(_a,_a,M([],[2,-1,2])),l(_a,_a,h([],[-ga[0],0,-ga[1]]));var Pa=[],Sa=Math.sin(1.5708),Ea=Math.cos(1.5708);Pa[0]=1,Pa[1]=0,Pa[2]=0,Pa[3]=0,Pa[4]=0,Pa[5]=Ea,Pa[6]=Sa,Pa[7]=0,Pa[8]=0,Pa[9]=-Sa,Pa[10]=Ea,Pa[11]=0,Pa[12]=0,Pa[13]=0,Pa[14]=0,Pa[15]=1,l(_a,_a,Pa);for(let t of Da){let a=t.map(t=>y([],t,_a)),e=gt([],a[1],a[0],a[2],a[0]);0>e[1]&&(a.reverse(),s(e,e,-1)),g(e,e);let r=It;_t(a,ct,e);let o=Mt.length;Mt.push({p:0===o?90:50*Math.random(),_:pt(a),type:"growing"}),Ia.push(ha(a,o));for(let t=r;t<It;t++)qa[t]=o}for(let t of Xa){let a=t.map(t=>y([],xa[t],_a)),e=gt([],a[1],a[0],a[2],a[0]);0>e[1]&&(a.reverse(),s(e,e,-1)),g(e,e),_t(a,ft,e)}let Ga=It,Ta=.6*Math.random()+.2,Ua=.6*Math.random()+.2,ja=[],Ha=.1;for(;.4>Ha&&100>ja.length;){let t=Math.random(),a=Math.random(),e=[t,a,0];if(Ha*=1.02,Math.hypot(Ta-t,Ua-a)<Ha&&va(t,a)&&.14<da(t,a)&&!ka.some(e=>dt(e,X,[t,a,0]))&&ja.every(t=>.012<b(e,t))){let r=ma(t,a),o=0;for(let e=5;e--;)o=Math.max(o,ma(t+.009*Math.sin(e/5*6.2832),a+.009*Math.cos(e/5*6.2832))-r);ja.push(e.slice()),e[0]=2*(e[0]-ga[0]),e[2]=2*(e[1]-ga[1]),e[1]=r+o;let i=n();l(i,i,h([],e)),l(i,i,M([],[.018,.018,.018]));var Ja=i,Ka=i,La=[],Na=6.2832*Math.random(),Oa=Math.sin(Na),Qa=Math.cos(Na);La[0]=Qa,La[1]=0,La[2]=-Oa,La[3]=0,La[4]=0,La[5]=1,La[6]=0,La[7]=0,La[8]=Oa,La[9]=0,La[10]=Qa,La[11]=0,La[12]=0,La[13]=0,La[14]=0,La[15]=1,l(Ja,Ka,La),Ia.push(Ma(i)),za=0}}let Ra=1e-5,Va=1e-5;for(;!va(Ra,Va)||.14>da(Ra,Va)||Da.some(t=>dt(t,X,[Ra,Va,0]));)Ra=.6*Math.random()+.2,Va=.6*Math.random()+.2;let Wa=()=>{var t=.02;for(let a=150;a--;){const a=Ra+2*(Math.random()-.5)*t,e=Va+2*(Math.random()-.5)*t,r=[a,e,0];if(0<=a&&1>a&&0<=e&&1>e&&Math.hypot(Ra-a,Va-e)<t&&va(a,e)&&.14<da(a,e)&&!Da.some(t=>dt(t,X,[a,e,0]))&&ja.every(t=>.001<b(r,t)))return r[0]=2*(r[0]-ga[0]),r[2]=2*(r[1]-ga[1]),r[1]=5,t=Rt(r,z,Yt,Ga),r[1]=t.s[1],r;t+=.012}return[0,-10,0]},Za=[],$a=[],te=[];Ia.push(()=>{for(;void 0!==nt[Za.length];){var t=At([],Da[nt[Za.length]]);y(t,t,_a),t[1]+=.016;var a=Wa();a[1]+=.008;for(let t of Za).00512>b(a,t)&&(i(a,t),a[1]+=.01648);let e=[(t[0]+a[0])/2,1.2,(t[2]+a[2])/2];Za.push(a),$a.push({a:t,b:a,c:e,angle:6.2832*Math.random(),P:ot,duration:.4*(v(t,e)+v(e,a))})}for(t=$a.length;t--;){let{a:e,b:r,c:o,P:n,duration:l}=$a[t];a=Math.min((ot-n)/l,1),h(te,[e[0]*(1-a)*(1-a)+o[0]*(1-a)*a+r[0]*a*a,e[1]*(1-a)*(1-a)+o[1]*(1-a)*a+r[1]*a*a,e[2]*(1-a)*(1-a)+o[2]*(1-a)*a+r[2]*a*a]),1===a?($a.splice(t,1),ca(te,St)):ca(te,kt)}});let ae,ee=([{pageX:t,pageY:a}])=>{(t=Nt(t/window.innerWidth*2-1,-(a/window.innerHeight*2-1),Yt,Ga))&&void 0!==qa[t.v]&&lt.push({type:"work-cell",cellIndex:qa[t.v],S:t.s})},re=0;t.addEventListener("mousedown",t=>{t=[t],re=Date.now(),ae=t,$(t)}),t.addEventListener("mousemove",t=>{Z(t=[t]),W(t),Zt(t)}),t.addEventListener("mouseup",()=>{R=Q=null,$([]),Date.now()<re+300&&ee(ae)}),t.addEventListener("touchstart",t=>{t=Array.from(t.touches),re=Date.now(),ae=t,$(t)},{passive:1}),t.addEventListener("touchmove",t=>{t=Array.from(t.touches),Z(t),W(t),Zt(t)},{passive:1}),t.addEventListener("touchend",t=>{t=Array.from(t.touches),R=Q=null,$(t),Date.now()<re+300&&ee(ae)},{passive:1});let oe=[0,-10,0],ne=(t,a,e)=>(e=t.createShader(e),t.shaderSource(e,a),t.compileShader(e),e),le=(t,a,e)=>(a=t.getAttribLocation(a,e),t.enableVertexAttribArray(a),a);var he;{const t=ne(e,"attribute vec3 a;attribute vec3 b;attribute vec3 c;uniform mat4 d;varying lowp vec3 f;varying lowp vec3 g;void main(void){gl_Position=d*vec4(a,1.);g=b;f=c;}",e.VERTEX_SHADER),a=ne(e,"precision highp float;varying lowp vec3 f;varying lowp vec3 g;uniform float e;void main(void){vec3 A=vec3(1.,0.8,1.);normalize(A);float B=dot(g,A);float C=e*2.*1.;vec3 D=vec3(sin(C),1.5,cos(C));normalize(D);float E=dot(g,D);gl_FragColor=vec4(f,1.);gl_FragColor.rgb*=0.6+clamp(B,-0.47,10.)*0.45;}",e.FRAGMENT_SHADER),r=e.createProgram();e.attachShader(r,t),e.attachShader(r,a),e.linkProgram(r),he=r}let Me=le(e,he,"c"),ie=le(e,he,"b"),fe=le(e,he,"a");var ce,se;ce=e.getUniformLocation(he,"e"),se=e.getUniformLocation(he,"d");let ue=Date.now(),ve=e.createBuffer(),we=new Uint16Array(1e5).map((t,a)=>a);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,ve),e.bufferData(e.ELEMENT_ARRAY_BUFFER,we,e.STATIC_DRAW);let ge=t=>{const a=e.createBuffer(),r=e.createBuffer(),o=e.createBuffer();let n=0;return{G(l,h,M,i){e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,l,t),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,h,t),e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,M,t),n=i},T(){e.useProgram(he),e.uniformMatrix4fv(se,0,K),e.uniform1f(ce,(Date.now()-ue)/1e3),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,ve),e.bindBuffer(e.ARRAY_BUFFER,o),e.vertexAttribPointer(Me,3,e.FLOAT,0,0,0),e.bindBuffer(e.ARRAY_BUFFER,r),e.vertexAttribPointer(ie,3,e.FLOAT,0,0,0),e.bindBuffer(e.ARRAY_BUFFER,a),e.vertexAttribPointer(fe,3,e.FLOAT,0,0,0),e.drawElements(e.TRIANGLES,n,e.UNSIGNED_SHORT,0)}}},de=ge(e.STATIC_DRAW),pe=ge(e.DYNAMIC_DRAW),Ae=0;e.clearColor(0,0,0,0),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),e.enable(e.CULL_FACE),e.cullFace(e.BACK),e.enable(e.DEPTH_TEST),e.depthFunc(e.LESS);let ye=()=>{Bt=0;for(let e=na.length;e--;){const{Y:r,color:o,duration:n,B:l,D:h,m:M,F:c,k:u,X:v}=na[e];var t=(ot-r)/n;if(!(1<t)){var a=1-(1-t)**2;A(C,M,c,a),t=(1-a)*u+a*v,a=(1-a)*l+a*h;for(let e=0;3>e;e++)i(q,la[e]),F(q,q,x,a),m(q,q,L),s(q,q,t),f(q,q,C),mt[9*Bt+3*e]=q[0],mt[9*Bt+3*e+1]=q[1],mt[9*Bt+3*e+2]=q[2],bt[9*Bt+3*e]=o[0],bt[9*Bt+3*e+1]=o[1],bt[9*Bt+3*e+2]=o[2],Ft[9*Bt+3*e]=0,Ft[9*Bt+3*e+1]=0,Ft[9*Bt+3*e+2]=1;Bt++}}for(const t of Ia)t();(()=>{const t=[k,Y,X];for(let a=3;a--;){const e=t[(a+0)%3],r=t[(a+1)%3],o=t[(a+2)%3],n=[[-1,1],[-1,-1],[1,-1],[1,1]];for(const t of[1,-1]){const a=n.map(([a,n])=>{const l=oe.slice();return u(l,l,o,.01*t),u(l,l,e,.01*a),u(l,l,r,.01*n),l});1===t&&a.reverse(),kt(a,o)}}})(),pe.G(bt,mt,Ft,3*Bt),Ae<It&&(de.G(qt,Yt,Ct,3*It),Ae=It),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),de.T(),pe.T()};ye();let me=()=>{ye();{const t=1/60;for(ot+=t;lt.length;){const t=lt.shift();switch(t.type){case"work-cell":{const a=Mt[t.cellIndex];switch(a.type){case"grown":a.U++,a.j=ot,ht.push({s:t.S,v:t.cellIndex,g:ot}),11<=a.U&&(a.p=0,a.type="growing",a.C=ot,nt.push(t.cellIndex))}}}}for(const a of Mt)switch(a.type){case"growing":a.p+=15*t,100<=a.p&&(a.p=100,a.type="grown",a.H=ot,a.A=0,a.U=0,a.J=0);break;case"grown":ot>a.j+.45&&a.U&&(a.U=Math.max(0,a.U-Math.min(14,.1+22*a.U)*t)),a.J+=(120*(a.U-a.A)-6*a.J)*t,a.A+=a.J*t}for(;ht[0]&&ht[0].g+500<ot;)ht.shift()}requestAnimationFrame(me)},Fe=document.getElementById("splash"),be=()=>{Fe.removeEventListener("click",be),Fe.style.opacity="0",setTimeout(()=>Fe.parentElement.removeChild(Fe),200),me()};Fe.addEventListener("click",be);</script></html>